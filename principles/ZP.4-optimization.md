# ZP.4 — Оптимизация

## Определение

Ставь задачу как поиск экстремума функционала (вариационные принципы).

## Следствие

Вместо «перебери все варианты» — сформулируй, что именно оптимизируешь, и ищи экстремум. Природа работает через оптимизацию (принцип наименьшего действия), инженерия — тоже.

## Примеры применения

**1. Free Energy Principle как вариационная оптимизация (Friston, 2023--2025).**
Планирование под FEP = минимизация вариационной свободной энергии на генеративной модели с эпистемическими и прагматическими приорами. «Active inference goes to school» (Phil Trans R Soc B, 2024): обучение = эпистемическое фуражирование и минимизация ошибки предсказания. Динамическое программирование снижает вычислительную стоимость долгосрочного планирования.

**2. Physics-Informed Neural Networks + Optimal Transport (2024--2025).**
AAS (Adversarial Adaptive Sampling): PINN + оптимальный транспорт, расстояние Вассерштейна в функции потерь. MC-PINN снижает ошибки климатического прогноза на 37% при 82% меньших вычислениях. SeisPINN: локализация землетрясений с точностью 0.5 км за 5 сек. PIKANs (Physics-Informed Kolmogorov-Arnold Networks, 2025) превосходят MLP-PINNs для многомасштабных задач.

**3. Grokking как фазовый переход при оптимизации (ICLR 2024).**
Сеть при обучении проходит фазовый переход от запоминания к обобщению. Сложность (по Колмогорову) растёт в фазе запоминания, затем резко падает при обнаружении паттерна. Прямое доказательство: оптимизация ведёт к сжатию (ZP.5), а сжатие происходит через фазовый переход (ZP.3).

**4. Оптимальный транспорт в генеративных моделях (2024--2025).**
OT — математический каркас для сравнения распределений в GAN, диффузионных моделях и динамике токенов трансформера. Тренировка нейросетей через градиентные потоки (IEEE, 2025). Wasserstein distance = «стоимость переноса» одного распределения в другое.

**5. Многоцелевая Парето-оптимизация в RL (ICLR 2025).**
C-MORL: мост между constrained policy optimization и multi-objective RL для обнаружения фронта Парето. Обработка до 9 одновременных целей в задачах непрерывного управления. Парето-оптимальность = когда нельзя улучшить одну цель, не ухудшив другую.

## Типичные нарушения

**N1. Одноцелевая ловушка.** Оптимизация одной метрики (next-token prediction loss) без учёта других целей ведёт к diminishing returns. Переход к multi-objective training (helpfulness + harmlessness + honesty) и test-time compute показывает: реальные системы требуют многоцелевых вариационных формулировок.

**N2. Некорректная обусловленность при вариационной оптимизации (2025).** Статья "Fundamental flaws of PINNs" демонстрирует случаи, где вариационная оптимизация отказывает из-за плохой обусловленности якобиана. Без правильной формулировки ограничений ландшафт оптимизации становится патологическим.

**N3. Парето-оптимизация на тестовых задачах ≠ на реальных.** MOEAs с сильными результатами на стандартных тестах проваливаются на реальных задачах (стохастические цели, тяжёлые ограничения, сложные фронты Парето). Допущение «чистая оптимизация достаточна без учёта структуры задачи» — нарушение.

**N4. Зубрёжка как брутфорс без модели.** Обучение без оптимизируемого критерия (просто «прочитай и запомни») — антитеза вариационному подходу. Retrieval practice (EDU.M.006, d=0.50) работает именно потому, что создаёт внутренний оптимизируемый сигнал (ошибка при попытке вспомнить).

## Проявление в развитии ребёнка

Исследование детей (Nature Human Behaviour, 2023) формально моделирует развитие как многопараметрическую оптимизацию: дети одновременно настраивают обобщение вознаграждения, температуру exploration и направленность исследования. Дети исследуют активнее взрослых (высокая exploration temperature), но получают меньше вознаграждения — они оптимизируют информационный выигрыш (epistemic value), а не награду (pragmatic value). Это зеркалит баланс эпистемических и прагматических приоров в FEP.

## Связь с FPF

FPF Part B: NQD-CAL — Novelty-Quality-Diversity optimization. Эволюционный поиск по трём осям: новизна, качество, разнообразие. Не скаляризация в одну метрику, а Парето-фронт. E/E-LOG: Explore-Exploit governance — именованные политики баланса исследования и эксплуатации. Trust Calculus: R (reliability) как объект оптимизации — монотонно улучшается через формализацию (↑F), расширение (↑G), репликацию (↑R).

## Ключевые исследователи (2024--2026)

- Karl Friston (UCL) — Free Energy Principle, active inference
- Gabriel Peyre (ENS Paris) — оптимальный транспорт
- George Karniadakis (Brown) — scientific ML, PINNs
- Marco Cuturi (Apple/CREST) — вычислительный оптимальный транспорт
- Maziar Raissi (Colorado) — PINNs pioneer
